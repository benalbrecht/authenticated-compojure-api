<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><title>authenticated-compojure-api.queries.query-defs documentation</title></head><body><header><section class="title"><h1><a href="index.html">Authenticated-compojure-api Api Documentation</a></h1></section><small>Version: 0.1.0-SNAPSHOT</small></header><section class="container"><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>authenticated-compojure-api</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>auth-resources</span></div></div></li><li class="depth-3 branch"><a href="authenticated-compojure-api.auth-resources.basic-auth-backend.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>basic-auth-backend</span></div></a></li><li class="depth-3"><a href="authenticated-compojure-api.auth-resources.token-auth-backend.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>token-auth-backend</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>general-functions</span></div></div></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>user</span></div></div></li><li class="depth-4"><a href="authenticated-compojure-api.general-functions.user.create-token.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>create-token</span></div></a></li><li class="depth-2 branch"><a href="authenticated-compojure-api.handler.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>handler</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>middleware</span></div></div></li><li class="depth-3 branch"><a href="authenticated-compojure-api.middleware.authenticated.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>authenticated</span></div></a></li><li class="depth-3 branch"><a href="authenticated-compojure-api.middleware.basic-auth.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>basic-auth</span></div></a></li><li class="depth-3 branch"><a href="authenticated-compojure-api.middleware.cors.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cors</span></div></a></li><li class="depth-3"><a href="authenticated-compojure-api.middleware.token-auth.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>token-auth</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>queries</span></div></div></li><li class="depth-3 current"><a href="authenticated-compojure-api.queries.query-defs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>query-defs</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>route-functions</span></div></div></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>auth</span></div></div></li><li class="depth-4"><a href="authenticated-compojure-api.route-functions.auth.get-auth-credentials.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>get-auth-credentials</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>password</span></div></div></li><li class="depth-4 branch"><a href="authenticated-compojure-api.route-functions.password.password-reset.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>password-reset</span></div></a></li><li class="depth-4"><a href="authenticated-compojure-api.route-functions.password.request-password-reset.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>request-password-reset</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>permission</span></div></div></li><li class="depth-4 branch"><a href="authenticated-compojure-api.route-functions.permission.add-user-permission.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>add-user-permission</span></div></a></li><li class="depth-4"><a href="authenticated-compojure-api.route-functions.permission.delete-user-permission.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>delete-user-permission</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>refresh-token</span></div></div></li><li class="depth-4 branch"><a href="authenticated-compojure-api.route-functions.refresh-token.delete-refresh-token.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>delete-refresh-token</span></div></a></li><li class="depth-4"><a href="authenticated-compojure-api.route-functions.refresh-token.gen-new-token.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>gen-new-token</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>user</span></div></div></li><li class="depth-4 branch"><a href="authenticated-compojure-api.route-functions.user.create-user.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>create-user</span></div></a></li><li class="depth-4 branch"><a href="authenticated-compojure-api.route-functions.user.delete-user.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>delete-user</span></div></a></li><li class="depth-4"><a href="authenticated-compojure-api.route-functions.user.modify-user.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>modify-user</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -486px;"><span class="top" style="height: 495px;"></span><span class="bottom"></span></span><span>routes</span></div></div></li><li class="depth-3 branch"><a href="authenticated-compojure-api.routes.auth.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>auth</span></div></a></li><li class="depth-3 branch"><a href="authenticated-compojure-api.routes.password.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>password</span></div></a></li><li class="depth-3 branch"><a href="authenticated-compojure-api.routes.permission.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>permission</span></div></a></li><li class="depth-3 branch"><a href="authenticated-compojure-api.routes.preflight.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>preflight</span></div></a></li><li class="depth-3 branch"><a href="authenticated-compojure-api.routes.refresh-token.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>refresh-token</span></div></a></li><li class="depth-3"><a href="authenticated-compojure-api.routes.user.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>user</span></div></a></li><li class="depth-2"><a href="authenticated-compojure-api.server.html"><div class="inner"><span class="tree" style="top: -207px;"><span class="top" style="height: 216px;"></span><span class="bottom"></span></span><span>server</span></div></a></li></ul></div><section class="namespace-docs" id="content"><h2 class="anchor" id="top">authenticated-compojure-api.queries.query-defs</h2><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-all-registered-users"><h3><a href="#var-all-registered-users">all-registered-users</a></h3><div class="usage"><code>(all-registered-users)</code><code>(all-registered-users {} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>Selects all registered-users</p></div></div></div><div class="public anchor" id="var-create-basic-permission-if-not-exists.21"><h3><a href="#var-create-basic-permission-if-not-exists.21">create-basic-permission-if-not-exists!</a></h3><div class="usage"><code>(create-basic-permission-if-not-exists!)</code><code>(create-basic-permission-if-not-exists! {} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>create the &lsquo;basic&rsquo; permission if it does not exist</p></div></div></div><div class="public anchor" id="var-create-password-reset-key-table-if-not-exists.21"><h3><a href="#var-create-password-reset-key-table-if-not-exists.21">create-password-reset-key-table-if-not-exists!</a></h3><div class="usage"><code>(create-password-reset-key-table-if-not-exists!)</code><code>(create-password-reset-key-table-if-not-exists! {} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>create the password_reset_key table if it does not exist</p></div></div></div><div class="public anchor" id="var-create-permission-table-if-not-exists.21"><h3><a href="#var-create-permission-table-if-not-exists.21">create-permission-table-if-not-exists!</a></h3><div class="usage"><code>(create-permission-table-if-not-exists!)</code><code>(create-permission-table-if-not-exists! {} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>create the permission table if it does not exist</p></div></div></div><div class="public anchor" id="var-create-registered-user-table-if-not-exists.21"><h3><a href="#var-create-registered-user-table-if-not-exists.21">create-registered-user-table-if-not-exists!</a></h3><div class="usage"><code>(create-registered-user-table-if-not-exists!)</code><code>(create-registered-user-table-if-not-exists! {} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>create the registered_user table if it does not exist</p></div></div></div><div class="public anchor" id="var-create-user-permission-table-if-not-exists.21"><h3><a href="#var-create-user-permission-table-if-not-exists.21">create-user-permission-table-if-not-exists!</a></h3><div class="usage"><code>(create-user-permission-table-if-not-exists!)</code><code>(create-user-permission-table-if-not-exists! {} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>create the user_permission table if it does not exist</p></div></div></div><div class="public anchor" id="var-db-connection"><h3><a href="#var-db-connection">db-connection</a></h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-delete-registered-user.21"><h3><a href="#var-delete-registered-user.21">delete-registered-user!</a></h3><div class="usage"><code>(delete-registered-user! {:keys (id)})</code><code>(delete-registered-user! {:keys (id)} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>delete a single user matching provided id</p></div></div></div><div class="public anchor" id="var-delete-user-permission.21"><h3><a href="#var-delete-user-permission.21">delete-user-permission!</a></h3><div class="usage"><code>(delete-user-permission! {:keys (permission userid)})</code><code>(delete-user-permission! {:keys (permission userid)} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>delete a single user permission matching provided id and permission name</p></div></div></div><div class="public anchor" id="var-drop-password-reset-key-table.21"><h3><a href="#var-drop-password-reset-key-table.21">drop-password-reset-key-table!</a></h3><div class="usage"><code>(drop-password-reset-key-table!)</code><code>(drop-password-reset-key-table! {} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>drop the passowrd-reset-key table</p></div></div></div><div class="public anchor" id="var-drop-permission-table.21"><h3><a href="#var-drop-permission-table.21">drop-permission-table!</a></h3><div class="usage"><code>(drop-permission-table!)</code><code>(drop-permission-table! {} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>drop the permission table</p></div></div></div><div class="public anchor" id="var-drop-registered-user-table.21"><h3><a href="#var-drop-registered-user-table.21">drop-registered-user-table!</a></h3><div class="usage"><code>(drop-registered-user-table!)</code><code>(drop-registered-user-table! {} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>drop the registered_user table</p></div></div></div><div class="public anchor" id="var-drop-user-permission-table.21"><h3><a href="#var-drop-user-permission-table.21">drop-user-permission-table!</a></h3><div class="usage"><code>(drop-user-permission-table!)</code><code>(drop-user-permission-table! {} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>drop the user_permission table</p></div></div></div><div class="public anchor" id="var-get-password-reset-keys-for-userid"><h3><a href="#var-get-password-reset-keys-for-userid">get-password-reset-keys-for-userid</a></h3><div class="usage"><code>(get-password-reset-keys-for-userid {:keys (userid)})</code><code>(get-password-reset-keys-for-userid {:keys (userid)} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>get the password reset key(s) for a given userid</p></div></div></div><div class="public anchor" id="var-get-permissions-for-userid"><h3><a href="#var-get-permissions-for-userid">get-permissions-for-userid</a></h3><div class="usage"><code>(get-permissions-for-userid {:keys (userid)})</code><code>(get-permissions-for-userid {:keys (userid)} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>get all the permissions for a given userid</p></div></div></div><div class="public anchor" id="var-get-registered-user-by-email"><h3><a href="#var-get-registered-user-by-email">get-registered-user-by-email</a></h3><div class="usage"><code>(get-registered-user-by-email {:keys (email)})</code><code>(get-registered-user-by-email {:keys (email)} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>Selects the (id, email, username) for registered user matching the email</p></div></div></div><div class="public anchor" id="var-get-registered-user-by-id"><h3><a href="#var-get-registered-user-by-id">get-registered-user-by-id</a></h3><div class="usage"><code>(get-registered-user-by-id {:keys (id)})</code><code>(get-registered-user-by-id {:keys (id)} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>Selects the (id, email, username, password, refresh_token) for registered user matching the id</p></div></div></div><div class="public anchor" id="var-get-registered-user-by-username"><h3><a href="#var-get-registered-user-by-username">get-registered-user-by-username</a></h3><div class="usage"><code>(get-registered-user-by-username {:keys (username)})</code><code>(get-registered-user-by-username {:keys (username)} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>Selects the (id, email, username) for registered user matching the username</p></div></div></div><div class="public anchor" id="var-get-registered-user-details-by-email"><h3><a href="#var-get-registered-user-details-by-email">get-registered-user-details-by-email</a></h3><div class="usage"><code>(get-registered-user-details-by-email {:keys (email)})</code><code>(get-registered-user-details-by-email {:keys (email)} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>Selects user details for matching email</p></div></div></div><div class="public anchor" id="var-get-registered-user-details-by-refresh-token"><h3><a href="#var-get-registered-user-details-by-refresh-token">get-registered-user-details-by-refresh-token</a></h3><div class="usage"><code>(get-registered-user-details-by-refresh-token {:keys (refresh_token)})</code><code>(get-registered-user-details-by-refresh-token {:keys (refresh_token)} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>Selects user details for matching refresh token</p></div></div></div><div class="public anchor" id="var-get-registered-user-details-by-username"><h3><a href="#var-get-registered-user-details-by-username">get-registered-user-details-by-username</a></h3><div class="usage"><code>(get-registered-user-details-by-username {:keys (username)})</code><code>(get-registered-user-details-by-username {:keys (username)} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>Selects user details for matching username</p></div></div></div><div class="public anchor" id="var-get-reset-row-by-reset-key"><h3><a href="#var-get-reset-row-by-reset-key">get-reset-row-by-reset-key</a></h3><div class="usage"><code>(get-reset-row-by-reset-key {:keys (reset_key)})</code><code>(get-reset-row-by-reset-key {:keys (reset_key)} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>get the row containing the specified reset_key</p></div></div></div><div class="public anchor" id="var-insert-password-reset-key-with-default-valid-until.3C.21"><h3><a href="#var-insert-password-reset-key-with-default-valid-until.3C.21">insert-password-reset-key-with-default-valid-until&lt;!</a></h3><div class="usage"><code>(insert-password-reset-key-with-default-valid-until&lt;! {:keys (reset_key user_id)})</code><code>(insert-password-reset-key-with-default-valid-until&lt;! {:keys (reset_key user_id)} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>inserts a row in the password_reset_key table using the default valid until timestamp</p></div></div></div><div class="public anchor" id="var-insert-password-reset-key-with-provide-valid-until-date.3C.21"><h3><a href="#var-insert-password-reset-key-with-provide-valid-until-date.3C.21">insert-password-reset-key-with-provide-valid-until-date&lt;!</a></h3><div class="usage"><code>(insert-password-reset-key-with-provide-valid-until-date&lt;! {:keys (valid_until reset_key user_id)})</code><code>(insert-password-reset-key-with-provide-valid-until-date&lt;! {:keys (valid_until reset_key user_id)} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>inserts a row in the password_reset_key table using the provided valid until timestamp</p></div></div></div><div class="public anchor" id="var-insert-permission-for-user.3C.21"><h3><a href="#var-insert-permission-for-user.3C.21">insert-permission-for-user&lt;!</a></h3><div class="usage"><code>(insert-permission-for-user&lt;! {:keys (permission userid)})</code><code>(insert-permission-for-user&lt;! {:keys (permission userid)} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>inserts the specified permission for the designated user</p></div></div></div><div class="public anchor" id="var-insert-permission.3C.21"><h3><a href="#var-insert-permission.3C.21">insert-permission&lt;!</a></h3><div class="usage"><code>(insert-permission&lt;! {:keys (permission)})</code><code>(insert-permission&lt;! {:keys (permission)} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>inserts a single permission into the permission table</p></div></div></div><div class="public anchor" id="var-insert-registered-user.3C.21"><h3><a href="#var-insert-registered-user.3C.21">insert-registered-user&lt;!</a></h3><div class="usage"><code>(insert-registered-user&lt;! {:keys (email password username)})</code><code>(insert-registered-user&lt;! {:keys (email password username)} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>inserts a single user</p></div></div></div><div class="public anchor" id="var-invalidate-reset-key.3C.21"><h3><a href="#var-invalidate-reset-key.3C.21">invalidate-reset-key&lt;!</a></h3><div class="usage"><code>(invalidate-reset-key&lt;! {:keys (reset_key)})</code><code>(invalidate-reset-key&lt;! {:keys (reset_key)} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>sets the <code>already_used</code> value of a specified reset_key ture</p></div></div></div><div class="public anchor" id="var-null-refresh-token.3C.21"><h3><a href="#var-null-refresh-token.3C.21">null-refresh-token&lt;!</a></h3><div class="usage"><code>(null-refresh-token&lt;! {:keys (refresh_token)})</code><code>(null-refresh-token&lt;! {:keys (refresh_token)} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>set refresh token to null for row matching the given refresh token</p></div></div></div><div class="public anchor" id="var-truncate-all-tables-in-database.21"><h3><a href="#var-truncate-all-tables-in-database.21">truncate-all-tables-in-database!</a></h3><div class="usage"><code>(truncate-all-tables-in-database!)</code><code>(truncate-all-tables-in-database! {} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>Truncate all tables in the database. Obviously very destructive only use in tests</p></div></div></div><div class="public anchor" id="var-update-registered-user-password.3C.21"><h3><a href="#var-update-registered-user-password.3C.21">update-registered-user-password&lt;!</a></h3><div class="usage"><code>(update-registered-user-password&lt;! {:keys (password id)})</code><code>(update-registered-user-password&lt;! {:keys (password id)} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>update the password for the user matching the given userid</p></div></div></div><div class="public anchor" id="var-update-registered-user-refresh-token.3C.21"><h3><a href="#var-update-registered-user-refresh-token.3C.21">update-registered-user-refresh-token&lt;!</a></h3><div class="usage"><code>(update-registered-user-refresh-token&lt;! {:keys (refresh_token id)})</code><code>(update-registered-user-refresh-token&lt;! {:keys (refresh_token id)} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>update the refresh token for the user matching the given userid</p></div></div></div><div class="public anchor" id="var-update-registered-user.3C.21"><h3><a href="#var-update-registered-user.3C.21">update-registered-user&lt;!</a></h3><div class="usage"><code>(update-registered-user&lt;! {:keys (email password refresh_token username id)})</code><code>(update-registered-user&lt;! {:keys (email password refresh_token username id)} {:keys [connection]})</code></div><div class="doc"><div class="markdown"><p>update a single user matching provided id</p></div></div></div></section></section></body></html>